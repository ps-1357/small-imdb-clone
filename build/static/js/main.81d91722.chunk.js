(this["webpackJsonpgo-movies"]=this["webpackJsonpgo-movies"]||[]).push([[0],{29:function(e,t,a){},36:function(e,t,a){},37:function(e,t,a){},39:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),r=a(19),i=a.n(r),c=(a(29),a(10)),o=a(5),l=a(6),d=a(13),h=a(8),j=a(7),m=a(3),u=a(2),b=a(0),p=function(e){Object(h.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={movies:[],isLoaded:!1,error:null},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;fetch("".concat("https://api.kianote.xyz","/v1/movies")).then((function(t){if("200"!==t.status){var a=Error;a.message="Invalid response code: "+t.status,e.setState({error:a})}return t.json()})).then((function(t){e.setState({movies:t.movies,isLoaded:!0},(function(t){e.setState({isLoaded:!0,error:t})}))}))}},{key:"render",value:function(){var e=this.state,t=e.movies,a=e.isLoaded,s=e.error;return s?Object(b.jsxs)("div",{children:["Error: ",s.message]}):a?Object(b.jsxs)(n.Fragment,{children:[Object(b.jsx)("h2",{children:"Choose a movie"}),Object(b.jsx)("div",{className:"list-group",children:t.map((function(e){return Object(b.jsx)(m.b,{className:"list-group-item list-group-item-action",to:"/movies/".concat(e.id),children:e.title},e.id)}))})]}):Object(b.jsx)("p",{children:"Loading..."})}}]),a}(n.Component),v=function(e){Object(h.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={movies:[],isLoaded:!1,error:null},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;""!==this.props.jwt?fetch("".concat("https://api.kianote.xyz","/v1/movies")).then((function(t){if("200"!==t.status){var a=Error;a.message="Invalid response code: "+t.status,e.setState({error:a})}return t.json()})).then((function(t){e.setState({movies:t.movies,isLoaded:!0},(function(t){e.setState({isLoaded:!0,error:t})}))})):this.props.history.push({pathname:"/login"})}},{key:"render",value:function(){var e=this.state,t=e.movies,a=e.isLoaded,s=e.error;return s?Object(b.jsxs)("div",{children:["Error: ",s.message]}):a?Object(b.jsxs)(n.Fragment,{children:[Object(b.jsx)("h2",{children:"Manage Catalogue"}),Object(b.jsx)("hr",{}),Object(b.jsx)("div",{className:"list-group",children:t.map((function(e){return Object(b.jsx)(m.b,{className:"list-group-item list-group-item-action",to:"/admin/movie/".concat(e.id),children:e.title},e.id)}))})]}):Object(b.jsx)("p",{children:"Loading..."})}}]),a}(n.Component),O=a.p+"static/media/movie_tickets.8bbaed34.jpg",g=(a(36),function(e){Object(h.a)(a,e);var t=Object(j.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return Object(b.jsxs)("div",{className:"text-center",children:[Object(b.jsx)("h2",{children:"This is the home page"}),Object(b.jsx)("hr",{}),Object(b.jsx)("img",{src:O,alt:"movie ticket"}),Object(b.jsx)("hr",{}),Object(b.jsx)("div",{className:"tickets"})]})}}]),a}(n.Component)),x=function(e){Object(h.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={movie:{},isLoaded:!1,error:null},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;fetch("".concat("https://api.kianote.xyz","/v1/movie/")+this.props.match.params.id).then((function(t){if("200"!==t.status){var a=Error;a.message="Invalid response code: "+t.status,e.setState({error:a})}return t.json()})).then((function(t){e.setState({movie:t.movie,isLoaded:!0},(function(t){e.setState({isLoaded:!0,error:t})}))}))}},{key:"render",value:function(){var e=this.state,t=e.movie,a=e.isLoaded,s=e.error;return t.genres?t.genres=Object.values(t.genres):t.genres=[],s?Object(b.jsxs)("div",{children:["Error: ",s.message]}):a?Object(b.jsxs)(n.Fragment,{children:[Object(b.jsxs)("h2",{children:["Movie: ",t.title," (",t.year,")"]}),Object(b.jsx)("div",{className:"float-start",children:Object(b.jsxs)("small",{children:["Rating: ",t.mpaa_rating]})}),Object(b.jsx)("div",{className:"float-end",children:t.genres.map((function(e,t){return Object(b.jsx)("span",{className:"badge bg-secondary me-1",children:e},t)}))}),Object(b.jsx)("div",{className:"clearfix"}),Object(b.jsx)("hr",{}),Object(b.jsxs)("table",{className:"table table-compact table-striped",children:[Object(b.jsx)("thead",{}),Object(b.jsxs)("tbody",{children:[Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{children:Object(b.jsx)("strong",{children:"Title:"})}),Object(b.jsx)("td",{children:t.title})]}),Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{children:Object(b.jsx)("strong",{children:"Description:"})}),Object(b.jsx)("td",{children:t.description})]}),Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{children:Object(b.jsx)("strong",{children:"Run time:"})}),Object(b.jsxs)("td",{children:[t.runtime," minutes"]})]})]})]})]}):Object(b.jsx)("p",{children:"Loading..."})}}]),a}(n.Component),f=function(e){Object(h.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={genres:[],isLoaded:!1,error:null},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;fetch("".concat("https://api.kianote.xyz","/v1/genres")).then((function(t){if("200"!==t.status){var a=Error;a.message="Invalid response code: "+t.status,e.setState({error:a})}return t.json()})).then((function(t){e.setState({genres:t.genres,isLoaded:!0},(function(t){e.setState({isLoaded:!0,error:t})}))}))}},{key:"render",value:function(){var e=this.state,t=e.genres,a=e.isLoaded,s=e.error;return s?Object(b.jsxs)("div",{children:["Error: ",s.message]}):a?Object(b.jsxs)(n.Fragment,{children:[Object(b.jsx)("h2",{children:"Genres"}),Object(b.jsx)("div",{className:"list-group",children:t.map((function(e){return Object(b.jsx)(m.b,{className:"list-group-item list-group-item-action",to:{pathname:"/genre/".concat(e.id),genreName:e.genre_name},children:e.genre_name},e.id)}))})]}):Object(b.jsx)("p",{children:"Loading..."})}}]),a}(n.Component),y=function(e){Object(h.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={movies:[],isLoaded:!1,error:null,genreName:""},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;fetch("".concat("https://api.kianote.xyz","/v1/movies/")+this.props.match.params.id).then((function(t){if("200"!==t.status){var a=Error;a.message="Invalid response code: "+t.status,e.setState({error:a})}return t.json()})).then((function(t){e.setState({movies:t.movies,isLoaded:!0,genreName:e.props.location.genreName},(function(t){e.setState({isLoaded:!0,error:t})}))}))}},{key:"render",value:function(){var e=this.state,t=e.movies,a=e.isLoaded,s=e.error,r=e.genreName;return t||(t=[]),s?Object(b.jsxs)("div",{children:["Error: ",s.message]}):a?Object(b.jsxs)(n.Fragment,{children:[Object(b.jsxs)("h2",{children:["Genre: ",r]}),Object(b.jsx)("div",{className:"list-group",children:t.map((function(e){return Object(b.jsx)(m.b,{to:"/movies/".concat(e.id),className:"list-group-item list-group-item-action",children:e.title},e.id)}))})]}):Object(b.jsx)("p",{children:"Loading..."})}}]),a}(n.Component),N=a(16),C=(a(37),function(e){return Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("label",{htmlFor:e.name,className:"form-label",children:e.title}),Object(b.jsx)("input",{className:"form-control ".concat(e.className),type:e.type,id:e.name,name:e.name,value:e.value,onChange:e.handleChange,placeholder:e.placeholder}),Object(b.jsx)("div",{className:e.errorDiv,children:e.errorMsg})]})}),S=function(e){return Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsxs)("label",{htmlFor:e.name,className:"form-label",children:[" ",e.title," "]}),Object(b.jsxs)("select",{className:"form-select",name:e.name,value:e.value,onChange:e.handleChange,children:[Object(b.jsx)("option",{value:"",children:e.placeholder}),e.options.map((function(e){return Object(b.jsx)("option",{className:"form-select",value:e.id,label:e.value,children:e.value},e.id)}))]})]})},w=function(e){return Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("label",{htmlFor:"description",className:"form-label",children:e.title}),Object(b.jsx)("textarea",{className:"form-control",id:e.name,name:e.name,value:e.value,onChange:e.handleChange,rows:e.rows})]})},k=function(e){return Object(b.jsx)("div",{className:"alert ".concat(e.alertType),role:"alert",children:e.alertMessage})},L=a(24),E=(a(38),function(e){Object(h.a)(a,e);var t=Object(j.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleSubmit=function(e){e.preventDefault();var t=[];if(""===n.state.movie.title&&t.push("title"),n.setState({errors:t}),t.length>0)return!1;var a=new FormData(e.target),s=Object.fromEntries(a.entries()),r=new Headers;r.append("Content-Type","application/json"),r.append("Authorization","Bearer "+n.props.jwt);var i={method:"POST",body:JSON.stringify(s),headers:r};fetch("".concat("https://api.kianote.xyz","/v1/admin/editmovie"),i).then((function(e){return e.json()})).then((function(e){e.error?n.setState({alert:{type:"alert-danger",message:e.error.message}}):n.props.history.push({pathname:"/admin"})}))},n.handleChange=function(e){var t=e.target.value,a=e.target.name;n.setState((function(e){return{movie:Object(c.a)(Object(c.a)({},e.movie),{},Object(N.a)({},a,t))}}))},n.confirmDelete=function(e){console.log("would delete id",n.state.movie.id),Object(L.confirmAlert)({title:"Delete Movie?",message:"Are you sure?",buttons:[{label:"Yes",onClick:function(){var e=new Headers;e.append("Content-Type","application.json"),e.append("Authorization","Bearer"+n.props.jwt),fetch("".concat("https://api.kianote.xyz","/v1/admin/deletemovie/")+n.state.movie.id,{method:"GET",headers:e}).then((function(e){return e.json})).then((function(e){e.error?n.setState({alert:{type:"alert-danger",message:e.error.message}}):(n.setState({alert:{type:"alert-success",message:"Movie deleted!"}}),n.props.history.push({pathname:"/admin"}))}))}},{label:"No",onClick:function(){}}]})},n.state={movie:{id:0,title:"",release_date:"",runtime:"",mpaa_rating:"",rating:"",description:""},mpaaOptions:[{id:"G",value:"G"},{id:"PG",value:"PG"},{id:"PG13",value:"PG13"},{id:"R",value:"R"},{id:"NC17",value:"NC17"}],isLoaded:!1,error:null,errors:[],alert:{type:"d-none",message:""}},n.handleChange=n.handleChange.bind(Object(d.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(d.a)(n)),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;if(""!==this.props.jwt){var t=this.props.match.params.id;t>0?fetch("".concat("https://api.kianote.xyz","/v1/movie/")+t).then((function(t){if("200"!==t.status){var a=Error;a.message="Invalid response code: "+t.status,e.setState({error:a})}return t.json()})).then((function(a){var n=new Date(a.movie.release_date);e.setState({movie:{id:t,title:a.movie.title,release_date:n.toISOString().split("T")[0],runtime:a.movie.runtime,mpaa_rating:a.movie.mpaa_rating,rating:a.movie.rating,description:a.movie.description},isLoaded:!0},(function(t){e.setState({isLoaded:!0,error:t})}))})):this.setState({isLoaded:!0})}else this.props.history.push({pathname:"/login"})}},{key:"hasError",value:function(e){return-1!==this.state.errors.indexOf(e)}},{key:"render",value:function(){var e=this,t=this.state,a=t.movie,s=t.isLoaded,r=t.error;return r?Object(b.jsxs)("div",{children:["Error: ",r.message]}):s?Object(b.jsxs)(n.Fragment,{children:[Object(b.jsx)("h2",{children:"Add/Edit Movie"}),Object(b.jsx)(k,{alertType:this.state.alert.type,alertMessage:this.state.alert.message}),Object(b.jsx)("hr",{}),Object(b.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(b.jsx)("input",{type:"hidden",name:"id",id:"id",value:a.id,onChange:this.handleChange}),Object(b.jsx)(C,{title:"Title",className:this.hasError("title")?"is-invalid":"",type:"text",name:"title",value:a.title,handleChange:this.handleChange,errorDiv:this.hasError("title")?"text-danger":"d-none",errorMsg:"Please enter a title"}),Object(b.jsx)(C,{title:"Release Date",type:"date",name:"release_date",value:a.release_date,handleChange:this.handleChange}),Object(b.jsx)(C,{title:"Runtime",type:"text",name:"runtime",value:a.runtime,handleChange:this.handleChange}),Object(b.jsx)(S,{title:"MPAA Rating",name:"mpaa_rating",options:this.state.mpaaOptions,value:a.mpaa_rating,handleChange:this.handleChange,placeholder:"Choose..."}),Object(b.jsx)(C,{title:"Rating",type:"text",name:"rating",value:a.rating,handleChange:this.handleChange}),Object(b.jsx)(w,{title:"Description",name:"description",value:a.description,rows:"3",handleChange:this.handleChange}),Object(b.jsx)("hr",{}),Object(b.jsx)("button",{className:"btn btn-primary",children:"Save"}),Object(b.jsx)(m.b,{to:"/admin",className:"btn btn-warning ms-1",children:"Cancel"}),a.id>0&&Object(b.jsx)("a",{href:"#!",onClick:function(){return e.confirmDelete()},className:"btn btn-danger ms-1",children:"Delete"})]})]}):Object(b.jsx)("p",{children:"Loading..."})}}]),a}(n.Component)),M=function(e){Object(h.a)(a,e);var t=Object(j.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleChange=function(e){var t=e.target.value,a=e.target.name;n.setState((function(e){return Object(c.a)(Object(c.a)({},e),{},Object(N.a)({},a,t))}))},n.handleSubmit=function(e){e.preventDefault();var t=[];if(""===n.state.email&&t.push("email"),""===n.state.password&&t.push("password"),n.setState({errors:t}),t.length>0)return!1;var a=new FormData(e.target),s=Object.fromEntries(a.entries()),r={method:"POST",body:JSON.stringify(s)};fetch("".concat("https://api.kianote.xyz","/v1/signin"),r).then((function(e){return e.json()})).then((function(e){e.error?n.setState({alert:{type:"alert-danger",message:e.error.message}}):(console.log(e),n.handleJWTChange(Object.values(e)[0]),window.localStorage.setItem("jwt",JSON.stringify(Object.values(e)[0])),n.props.history.push({pathname:"/admin"}))}))},n.state={email:"",password:"",error:null,errors:[],alert:{type:"d-none",message:""}},n.handleChange=n.handleChange.bind(Object(d.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(d.a)(n)),n}return Object(l.a)(a,[{key:"handleJWTChange",value:function(e){this.props.handleJWTChange(e)}},{key:"hasError",value:function(e){return-1!==this.state.errors.indexOf(e)}},{key:"render",value:function(){return Object(b.jsxs)(n.Fragment,{children:[Object(b.jsx)("h2",{children:"Login"}),Object(b.jsx)("hr",{}),Object(b.jsx)(k,{alertType:this.state.alert.type,alertMessage:this.state.alert.message}),Object(b.jsxs)("form",{className:"pt-3",onSubmit:this.handleSubmit,children:[Object(b.jsx)(C,{title:"Email",type:"email",name:"email",handleChange:this.handleChange,className:this.hasError("email")?"is-invalid":"",errorDiv:this.hasError("email")?"text-danger":"d-none",errorMsg:"Please enter a valid email address"}),Object(b.jsx)(C,{title:"Password",type:"password",name:"password",handleChange:this.handleChange,className:this.hasError("password")?"is-invalid":"",errorDiv:this.hasError("password")?"text-danger":"d-none",errorMsg:"Please enter a password"}),Object(b.jsx)("hr",{}),Object(b.jsx)("button",{className:"btn btn-primary",children:"Login"})]})]})}}]),a}(n.Component),D=function(e){Object(h.a)(a,e);var t=Object(j.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleJWTChange=function(e){n.setState({jwt:e})},n.logout=function(){n.setState({jwt:""}),window.localStorage.removeItem("jwt")},n.state={jwt:""},n.handleJWTChange(n.handleJWTChange.bind(Object(d.a)(n))),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=window.localStorage.getItem("jwt");e&&""===this.state.jwt&&this.setState({jwt:JSON.parse(e)})}},{key:"render",value:function(){var e,t=this;return e=""===this.state.jwt?Object(b.jsx)(m.b,{to:"/login",children:"Login"}):Object(b.jsx)(m.b,{to:"/logout",onClick:this.logout,children:"Logout"}),Object(b.jsx)(m.a,{children:Object(b.jsxs)("div",{className:"container",children:[Object(b.jsxs)("div",{className:"row",children:[Object(b.jsx)("div",{className:"col mt-3",children:Object(b.jsx)("h1",{className:"mt-3",children:"Go Watch a Movie!"})}),Object(b.jsx)("div",{className:"col mt-3 text-end",children:e}),Object(b.jsx)("hr",{className:"mb-3"})]}),Object(b.jsxs)("div",{className:"row",children:[Object(b.jsx)("div",{className:"col-md-2",children:Object(b.jsx)("nav",{children:Object(b.jsxs)("ul",{className:"list-group",children:[Object(b.jsx)("li",{className:"list-group-item",children:Object(b.jsx)(m.b,{to:"/",children:"Home"})}),Object(b.jsx)("li",{className:"list-group-item",children:Object(b.jsx)(m.b,{to:"/movies",children:"Movies"})}),Object(b.jsx)("li",{className:"list-group-item",children:Object(b.jsx)(m.b,{to:"/genres",children:"Genres"})}),""!==this.state.jwt&&Object(b.jsxs)(n.Fragment,{children:[Object(b.jsx)("li",{className:"list-group-item",children:Object(b.jsx)(m.b,{to:"/admin/movie/0",children:"Add movie"})}),Object(b.jsx)("li",{className:"list-group-item",children:Object(b.jsx)(m.b,{to:"/admin",children:"Manage Catalogue"})})]})]})})}),Object(b.jsx)("div",{className:"col-md-10",children:Object(b.jsxs)(u.c,{children:[Object(b.jsx)(u.a,{path:"/movies/:id",component:x}),Object(b.jsx)(u.a,{path:"/movies",children:Object(b.jsx)(p,{})}),Object(b.jsx)(u.a,{path:"/genre/:id",component:y}),Object(b.jsx)(u.a,{exact:!0,path:"/login",component:function(e){return Object(b.jsx)(M,Object(c.a)(Object(c.a)({},e),{},{handleJWTChange:t.handleJWTChange}))}}),Object(b.jsx)(u.a,{exact:!0,path:"/genres",children:Object(b.jsx)(f,{})}),Object(b.jsx)(u.a,{path:"/admin/movie/:id",component:function(e){return Object(b.jsx)(E,Object(c.a)(Object(c.a)({},e),{},{jwt:t.state.jwt}))}}),Object(b.jsx)(u.a,{path:"/admin",component:function(e){return Object(b.jsx)(v,Object(c.a)(Object(c.a)({},e),{},{jwt:t.state.jwt}))}}),Object(b.jsx)(u.a,{path:"/",children:Object(b.jsx)(g,{})})]})})]})]})})}}]),a}(n.Component);i.a.render(Object(b.jsx)(s.a.StrictMode,{children:Object(b.jsx)(D,{})}),document.getElementById("root"))}},[[39,1,2]]]);
//# sourceMappingURL=main.81d91722.chunk.js.map